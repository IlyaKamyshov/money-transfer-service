# Курсовой проект «Сервис перевода денег»
## Описание проекта

Данное приложение (REST-сервис) предоставляет интерфейс для перевода денег с одной карты на другую по заранее описанной спецификации.

Веб-приложение (FRONT) подключается к разработанному сервису без доработок и использует его функционал для перевода денег.

## Выполненные ребования к приложению

* Сервис предоставляет REST-интерфейс для интеграции с FRONT.
* Сервис реализует все методы перевода с одной банковской карты на другую, описанные [в протоколе](https://github.com/netology-code/jd-homeworks/blob/master/diploma/MoneyTransferServiceSpecification.yaml).
* Все изменения записываются в лог переводов с указанием:
  * даты,
  * времени,
  * карты, с которой было списание,
  * карты зачисления,
  * суммы,
  * результата операции и комиссии, если результат был.

## Описание реализации

* Приложение разработано с использованием Spring Boot.
* Использован сборщик пакетов Maven.
* Для запуска используется Docker, Docker Compose.
* Код размещён на GitHub.
* Приложение протестировано с помощью функционала HTTP Request в IJ Idea.
* Приложение протестировано с помощью юнит-тестов JUnit 5 / Mockito.
* Приложение протестировано с помощью Testcontainers.

## Архитектура приложения

Многослойная модель приложения:

* Controller используется для доступа к функционалу приложения.
* Service реализует бизнес-логику работы приложения.
* Repository реализует хранение операций по переводу денег.
* Model реализует шаблоны объектов данных с которыми работает приложение.
* Response реализует шаблоны ответов на запросы к контроллеру.
* Exception реализует обработчик исключений.
* Logger реализует логирование всех операций и ошибок.
* Utils реализует кастомные валидаторы и сервис отправки СМС с кодом подтверждения (в данный момент FRONT всегда отправляет в ответ 0000 по условиям проекта).

Настройки приложения хранятся в файле application.properties:

* server.port указывает TCP-порт на котором работает приложение.
* transfer.commission.percent указывает процент взимаемой за перевод комиссии.
* info.log.path указывает путь размещения лога операций.
* error.log.path указывает путь размещения лога ошибок.

## Функционал приложения

* `/transfer` принимает объект запроса на перевод, возвращает id операции или id ошибки.

  Выполняемые проверки:
    * Номер карты отправителя должен содержать 16 цифр.
    * CVV карты отправителя должен содержать 3 цифры.
    * Срок действия карты отправителя должен быть в формате MM/YY, а текущий месяц должен быть в диапазоне [1-12].
    * Срок действия карты не истек.
    * Сумма перевода должна быть не меньше 100 копеек/центов в зависимости от валюты перевода.
    * Допустимые для перевода валюты: RUR, EUR и USD.
    * Номер карты получателя должен содержать 16 цифр.


* `/confirmOperation` - принимает объект запроса на подтверждение с кодом подтверждения и id операции, возвращает id операции или id ошибки.

  Выполняемые проверки:
    * Код подтверждения должен совпадать с кодом, отправленном в СМС (в данный момент FRONT всегда отправляет в ответ 0000 по условиям проекта)
    * Операция с данным id не должна быть выполнена ранее.
    * Операция с данным id не существует.
    * При проведении операции с данным id ранее произошла ошибка.

При несоблюдении какой-либо из описанных выше проверок выбрасывается исключение и клиенту возвращается ответ с id ошибки и сообщением об ошибке.


## Запуск приложения

Находясь в терминале в корневой директории проекта следует ввести команду: ```docker-compose up```

## Логи приложения

Для просмотра логов приложения, запущенного в контейнере при настройках по-умолчанию, следует скопировать их введя команды: ```docker cp <container id>:/info.log ./info.log``` ```docker cp <container id>:/error.log ./error.```

## Описание интеграции с FRONT

FRONT (уже развёрнутое демо-приложение) доступен [по адресу](https://serp-ya.github.io/card-transfer/). Данное приложение при запуске должно быть доступно по адресу [по адресу](http://localhost:5500/).